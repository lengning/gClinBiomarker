<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute LSMEANS to mirror SAS functionality — sas.lsmeans • gClinBiomarker</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">gClinBiomarker</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example-use-cases.html">gClinBiomarker: Example Use Cases</a>
    </li>
    <li>
      <a href="../articles/package-overview.html">gClinBiomarker Package Overivew</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute LSMEANS to mirror SAS functionality</h1>
    </div>

    
    <p>Compute LSMEANS to mirror SAS functionality</p>
    

    <pre class="usage"><span class='fu'>sas.lsmeans</span>(<span class='no'>model.obj</span>, <span class='no'>specs</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"kenward-roger"</span>,
  <span class='kw'>quietly</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>confidence.level</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model.obj</th>
      <td><p>A model object on which to calculate lsmeans</p></td>
    </tr>
    <tr>
      <th>specs</th>
      <td><p>specs to be passed to lsmeans()</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>mode to be passed to lsmeans()</p></td>
    </tr>
    <tr>
      <th>quietly</th>
      <td><p>whether to hide message informing of changes to default
functionality</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to lsmeans</p></td>
    </tr>
    <tr>
      <th>as.data.frame</th>
      <td><p>whether to return a lsm.list object or a data.frame</p></td>
    </tr>
    </table>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>dplyr</span>) <span class='co'># for %&gt;% operator</span>
<span class='fu'>library</span>(<span class='no'>nlme</span>)  <span class='co'># for gls</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘nlme’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:dplyr’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    collapse</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:gClinBiomarker’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    collapse</span></div><div class='input'>
<span class='co'># create model on which to calculate lsmeans</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/nlme/topics/gls'>gls</a></span>(<span class='no'>mpg</span> ~ <span class='no'>hp</span> + <span class='no'>carb</span> + <span class='no'>wt</span>,
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>, <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='no'>na.exclude</span>)

<span class='co'># call lsmeans, specifying factors over which means should be calculated</span>
<span class='no'>sas.lsm</span> <span class='kw'>&lt;-</span> <span class='fu'>sas.lsmeans</span>(<span class='no'>model</span>, ~ <span class='no'>carb</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mtcars</span>, <span class='kw'>confidence.level</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>verb</span> <span class='kw'>=</span> <span class='no'>T</span>)</div><div class='output co'>#&gt; <span class='message'>To mirror SAS functionality:</span>
#&gt; <span class='message'> 1. mode of 'kenward-roger' will be used unless otherwise specified.</span>
#&gt; <span class='message'> 2. data used for initial model fit...</span>
#&gt; <span class='message'>   a. is filtered for only complete cases in the response variable</span>
#&gt; <span class='message'>   b. will have any numeric variables in specs converted to categorical</span>
#&gt; <span class='message'> 3. grouping variables for lsmeans converted to factor.</span>
#&gt; <span class='message'>      (creating a new factor column where necessary)</span>
#&gt; <span class='message'> 4. continuous means calculated using rows where response is not NA.</span>
#&gt; <span class='message'> 5. categorical level weights from all rows of dataset</span></div><div class='output co'>#&gt; <span class='message'>gls model is being refit with arguments: </span>
#&gt; <span class='message'>$model</span>
#&gt; <span class='message'>mpg ~ hp + carb + wt</span>
#&gt; <span class='message'>$data</span>
#&gt; <span class='message'>mtcars</span>
#&gt; <span class='message'>$na.action</span>
#&gt; <span class='message'>na.exclude</span></div><div class='output co'>#&gt; <span class='message'>Running lsmeans::lsmeans() with parameters: </span></div><div class='output co'>#&gt; <span class='message'>$object</span>
#&gt; <span class='message'>Generalized least squares fit by REML</span>
#&gt; <span class='message'>  Model: mpg ~ hp + carb + wt </span>
#&gt; <span class='message'>  Data: structure(list(mpg = c(21, 21, 22.8, 21.4, 18.7, 18.1, 14.3,  24.4, 22.8, 19.2, 17.8, 16.4, 17.3, 15.2, 10.4, 10.4, 14.7, 32.4,  30.4, 33.9, 21.5, 15.5, 15.2, 13.3, 19.2, 27.3, 26, 30.4, 15.8,  19.7, 15, 21.4), cyl = c(6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8,  8, 8, 8, 8, 8, 4, 4, 4, 4, 8, 8, 8, 8, 4, 4, 4, 8, 6, 8, 4),      disp = c(160, 160, 108, 258, 360, 225, 360, 146.7, 140.8,      167.6, 167.6, 275.8, 275.8, 275.8, 472, 460, 440, 78.7, 75.7,      71.1, 120.1, 318, 304, 350, 400, 79, 120.3, 95.1, 351, 145,      301, 121), hp = c(110, 110, 93, 110, 175, 105, 245, 62, 95,      123, 123, 180, 180, 180, 205, 215, 230, 66, 52, 65, 97, 150,      150, 245, 175, 66, 91, 113, 264, 175, 335, 109), drat = c(3.9,      3.9, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.92,      3.07, 3.07, 3.07, 2.93, 3, 3.23, 4.08, 4.93, 4.22, 3.7, 2.76,      3.15, 3.73, 3.08, 4.08, 4.43, 3.77, 4.22, 3.62, 3.54, 4.11     ), wt = c(2.62, 2.875, 2.32, 3.215, 3.44, 3.46, 3.57, 3.19,      3.15, 3.44, 3.44, 4.07, 3.73, 3.78, 5.25, 5.424, 5.345, 2.2,      1.615, 1.835, 2.465, 3.52, 3.435, 3.84, 3.845, 1.935, 2.14,      1.513, 3.17, 2.77, 3.57, 2.78), qsec = c(16.46, 17.02, 18.61,      19.44, 17.02, 20.22, 15.84, 20, 22.9, 18.3, 18.9, 17.4, 17.6,      18, 17.98, 17.82, 17.42, 19.47, 18.52, 19.9, 20.01, 16.87,      17.3, 15.41, 17.05, 18.9, 16.7, 16.9, 14.5, 15.5, 14.6, 18.6     ), vs = c(0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0,      0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1), am = c(1,      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,      0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1), gear = c(4, 4, 4, 3,      3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, 3, 3,      3, 3, 4, 5, 5, 5, 5, 5, 4), carb = structure(c(4L, 4L, 1L,      1L, 2L, 1L, 4L, 2L, 2L, 4L, 4L, 3L, 3L, 3L, 4L, 4L, 4L, 1L,      2L, 1L, 1L, 2L, 2L, 4L, 2L, 1L, 2L, 2L, 4L, 5L, 6L, 2L), .Label = c("1",      "2", "3", "4", "6", "8"), class = "factor")), class = "data.frame", .Names = c("mpg",  "cyl", "disp", "hp", "drat", "wt", "qsec", "vs", "am", "gear",  "carb"), row.names = c(NA, -32L)) </span>
#&gt; <span class='message'>       AIC      BIC    logLik</span>
#&gt; <span class='message'>  156.0622 166.6646 -69.03108</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Coefficients:</span>
#&gt; <span class='message'>               Value Std.Error   t-value p-value</span>
#&gt; <span class='message'>(Intercept) 37.19123  1.916554 19.405259  0.0000</span>
#&gt; <span class='message'>hp          -0.03517  0.014147 -2.485645  0.0203</span>
#&gt; <span class='message'>carb2       -0.52456  1.412113 -0.371469  0.7135</span>
#&gt; <span class='message'>carb3       -0.88226  2.228159 -0.395959  0.6956</span>
#&gt; <span class='message'>carb4       -1.01356  1.830877 -0.553595  0.5850</span>
#&gt; <span class='message'>carb6       -1.52087  3.173535 -0.479234  0.6361</span>
#&gt; <span class='message'>carb8        2.24066  4.309517  0.519932  0.6079</span>
#&gt; <span class='message'>wt          -3.54383  0.773606 -4.580932  0.0001</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'> Correlation: </span>
#&gt; <span class='message'>      (Intr) hp     carb2  carb3  carb4  carb6  carb8 </span>
#&gt; <span class='message'>hp    -0.075                                          </span>
#&gt; <span class='message'>carb2 -0.247 -0.199                                   </span>
#&gt; <span class='message'>carb3  0.099 -0.332  0.480                            </span>
#&gt; <span class='message'>carb4  0.135 -0.449  0.596  0.612                     </span>
#&gt; <span class='message'>carb6 -0.105 -0.359  0.325  0.296  0.377              </span>
#&gt; <span class='message'>carb8  0.055 -0.709  0.348  0.413  0.537  0.344       </span>
#&gt; <span class='message'>wt    -0.652 -0.557 -0.030 -0.143 -0.160  0.153  0.261</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Standardized residuals:</span>
#&gt; <span class='message'>                     Min                       Q1                      Med </span>
#&gt; <span class='message'>-1.453000733540340760896 -0.518130806197143023439  0.000000000000001605611 </span>
#&gt; <span class='message'>                      Q3                      Max </span>
#&gt; <span class='message'> 0.319725705209169319687  2.007393207317980987625 </span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Residual standard error: 2.765858 </span>
#&gt; <span class='message'>Degrees of freedom: 32 total; 24 residual</span></div><div class='output co'>#&gt; <span class='message'>$specs</span>
#&gt; <span class='message'>pairwise ~ carb</span>
#&gt; <span class='message'>&lt;environment: 0x11a9328a0&gt;</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>$mode</span>
#&gt; <span class='message'>[1] "kenward-roger"</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>$data</span>
#&gt; <span class='message'>    mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
#&gt; <span class='message'>1  21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
#&gt; <span class='message'>2  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
#&gt; <span class='message'>3  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1</span>
#&gt; <span class='message'>4  21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1</span>
#&gt; <span class='message'>5  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2</span>
#&gt; <span class='message'>6  18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1</span>
#&gt; <span class='message'>7  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4</span>
#&gt; <span class='message'>8  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2</span>
#&gt; <span class='message'>9  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2</span>
#&gt; <span class='message'>10 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</span>
#&gt; <span class='message'>11 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4</span>
#&gt; <span class='message'>12 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3</span>
#&gt; <span class='message'>13 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</span>
#&gt; <span class='message'>14 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3</span>
#&gt; <span class='message'>15 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4</span>
#&gt; <span class='message'>16 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span>
#&gt; <span class='message'>17 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4</span>
#&gt; <span class='message'>18 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1</span>
#&gt; <span class='message'>19 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2</span>
#&gt; <span class='message'>20 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1</span>
#&gt; <span class='message'>21 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1</span>
#&gt; <span class='message'>22 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2</span>
#&gt; <span class='message'>23 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2</span>
#&gt; <span class='message'>24 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4</span>
#&gt; <span class='message'>25 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2</span>
#&gt; <span class='message'>26 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1</span>
#&gt; <span class='message'>27 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2</span>
#&gt; <span class='message'>28 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2</span>
#&gt; <span class='message'>29 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</span>
#&gt; <span class='message'>30 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6</span>
#&gt; <span class='message'>31 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8</span>
#&gt; <span class='message'>32 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>$at</span>
#&gt; <span class='message'>$at$hp</span>
#&gt; <span class='message'>[1] 146.6875</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>$at$wt</span>
#&gt; <span class='message'>[1] 3.21725</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>$weights</span>
#&gt; <span class='message'>[1] "proportional"</span></div><div class='output co'>#&gt; <span class='message'>Coercing variables according to: $carb</span>
#&gt; <span class='message'>[1] "numeric"</span>
#&gt; <span class='message'></span></div><div class='input'>
<span class='co'># update the confidence level used</span>
<span class='co'># NOTE: if you're examining confidence intervals, it's much faster to udpate</span>
<span class='co'># rather than re-run the model and means</span>
<span class='no'>sas.lsm</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>sas.lsm</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>)

<span class='co'># using the means as a dataframe</span>
<span class='fu'>as.data.frame</span>(<span class='no'>sas.lsm</span>)</div><div class='output co'>#&gt;   carb carb.lsmeans.factor   lsmean        SE df lower.CL upper.CL .wgt.
#&gt; 1    1                   1 20.63151 1.2682590 24 18.01395 23.24906     7
#&gt; 2    2                   2 20.10695 0.9417013 24 18.16337 22.05053    10
#&gt; 3    3                   3 19.74925 1.6608191 24 16.32148 23.17701     3
#&gt; 4    4                   4 19.61794 1.0162966 24 17.52041 21.71548    10
#&gt; 5    6                   6 19.11064 2.8433240 24 13.24231 24.97897     1
#&gt; 6    8                   8 22.87216 3.7432900 24 15.14639 30.59793     1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
            
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Doug Kelkhoff <a href='mailto:kelkhoff.douglas@gene.com'>kelkhoff.douglas@gene.com</a>, Christina Rabe
  <a href='mailto:rabe.christina@gene.com'>rabe.christina@gene.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ning Leng, Alexey Pronin, Doug Kelkhoff, Christina Rabe, Kwame Okrah.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
