<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Box/Box-Percentile Plot with additional vertical stripchart, mean(s), and trend-lines. — BoxPlot • gClinBiomarker</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">gClinBiomarker</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example-use-cases.html">gClinBiomarker: Example Use Cases</a>
    </li>
    <li>
      <a href="../articles/package-overview.html">gClinBiomarker Package Overivew</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Box/Box-Percentile Plot with additional vertical stripchart, mean(s), and trend-lines.</h1>
    </div>

    
    <p>This function produces boxplots as function <code>boxplot</code> and box-percentile plots as function bpplot (package Hmisc),
offering a formula interface, data specification via a vector of variable names, as numeric matrix where all columns will be interpreted as
variables or by specifying one or multiple numeric vectors (see examples below). It additionally/optionally
adds vertical jitterplots to each boxplot, adds the number of observations, adds mean-values, and allows to add a trend-line connecting either
mean-values (trend="mean") or median-values (trend="median"). Furthermore, this function filters for groups with less than 'threshold'
observations. For these (sub-)groups no boxplots will be drawn but a jitterplot will be produced. Labels for each group (X-axis labels) can be customized via
'xlab.srt', 'xlab.cex', 'xlab.col', 'xlab.font'. Note: When using the formula-interface, one cannot specify formulas as in function 'boxplot'
i.e. using something like 'a + b' to get factor crossing, one has to use the correct formula instead as used in e.g. 'lm', i.e. 'a:b'.</p>
    

    <pre class="usage"><span class='fu'>BoxPlot</span>(<span class='no'>...</span>, <span class='no'>obj</span>, <span class='kw'>form</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>box.type</span> <span class='kw'>=</span> <span class='st'>"b"</span>,
  <span class='kw'>horizontal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"white"</span>, <span class='kw'>sc.col</span> <span class='kw'>=</span> <span class='st'>"#00000040"</span>, <span class='kw'>sc.pch</span> <span class='kw'>=</span> <span class='fl'>15L</span>,
  <span class='kw'>sc.cex</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>sc.jitter</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>Xaxis</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>mgp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>0.5</span>, <span class='fl'>0</span>),
  <span class='kw'>font</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>tick</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>Xaxis2</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>font</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>mgp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>0.5</span>,
  <span class='fl'>0</span>), <span class='kw'>tick</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>XaxisTab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>Yaxis</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>mgp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>1</span>,
  <span class='fl'>0</span>)), <span class='kw'>Ylabel</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>text</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>, <span class='kw'>font</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1</span>),
  <span class='kw'>Xlabel</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>text</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>, <span class='kw'>font</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1</span>),
  <span class='kw'>Title</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>), <span class='kw'>Grid</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>transf</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>trend</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>trend.lty</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>trend.lwd</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>trend.col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>5L</span>,
  <span class='kw'>border</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>mean.pch</span> <span class='kw'>=</span> <span class='fl'>3L</span>, <span class='kw'>mean.cex</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>mean.col</span> <span class='kw'>=</span> <span class='st'>"salmon"</span>,
  <span class='kw'>mean.lwd</span> <span class='kw'>=</span> <span class='fl'>2L</span>, <span class='kw'>vline</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>vl.lwd</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>vl.lty</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>vl.col</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>Box</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>a numeric matrix, multiple numeric vectors or a (possibly named) list with multiple numeric vectors to be plotted and additional
graphical parameters (identified by names) to be passed on.</p></td>
    </tr>
    <tr>
      <th>obj</th>
      <td><p>(data.frame, matrix) corresponding to the dataset to be used.</p></td>
    </tr>
    <tr>
      <th>form</th>
      <td><p>(formula) such as 'y~grp', where 'y' is a numeric vector of data values to be split into
groups according to the grouping variable 'grp'.</p></td>
    </tr>
    <tr>
      <th>var</th>
      <td><p>(character) vector specifying the columns in 'obj' to be used for plotting. The order of elements is retained in the boxplot.</p></td>
    </tr>
    <tr>
      <th>box.type</th>
      <td><p>(character) "b" = for regular boxes, "bp" = for box-percentile boxes
(see ? bpplot of package <code>Hmisc</code>).</p></td>
    </tr>
    <tr>
      <th>horizontal</th>
      <td><p>(logical) TRUE = the boxes are drawn horizontally, FALSE = vertical boxplot. Note, this has no effect when box.type="bp", since
   the underlying function bpplot of the <code>Hmisc</code> package cannot do it. Also note, that <code>horizontal=TRUE</code> automatically
changes the meaning of X- and Y-axis. All arguments referring to Y-axis will then implicitely mean the X-axis and vice versa.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>(character) string(s) specifying colors to be used to color the bodies of the box plots. By default they are in the background color.</p></td>
    </tr>
    <tr>
      <th>sc.col</th>
      <td><p>(character) string or vector of strings specifying color(s) of plotting symbols in the stripchart.
   By default "black" with 80% transparency (alpha=.2). In case of a vector of strings, it is best practise to provide as
   many elements as there are elements in 'obj', which can be used to highlight an additional grouping factor within a single box.
   Note, it is the responsibility of the user to provide 'sc.col', 'sc.pch' or 'sc.cex' in such a way, that the graphical output
is meaningful. In case of providing less than 'nrow(obj)' elements, 'sc.col' will be replicated to the required length.</p></td>
    </tr>
    <tr>
      <th>sc.pch</th>
      <td><p>(integer) value or vector of integers specifying plotting smybols for the stripchart. The same rules as for 'sc.col' and 'sc.cex' apply here.</p></td>
    </tr>
    <tr>
      <th>sc.cex</th>
      <td><p>(numeric) value or vector of numeric values specifying the magnification of plotting symbols in the stripchart. The same rules as for 'sc.col' and 'sc.cex' apply here.</p></td>
    </tr>
    <tr>
      <th>sc.jitter</th>
      <td><p>(numeric) specifying the amount of jittering in the stripchart.</p></td>
    </tr>
    <tr>
      <th>Xaxis</th>
      <td><p>(list) passed to function 'axis' which allows to fully specify the X-axis labelling (see ?axis). Default is to determine group labels
automatically and plotting group labels below the plot. Set to NULL for omitting group labels.
For custom group-labels use the list-element "labels". The order of these labels must correspond to the order of group-levels in case the
formula interface was used, i.e. check the order of sort(unique(obj$grp)). To obtain your desired ordering, specify classification variables as
factor-objects using 'factor(dat$trt, levels=c("Level_1", "Level_2", ..., "Level_n"))' where "trt" is the classification variable and Level_1 to Level_n
represents your desired order of factor levels (which is used in the plot).</p></td>
    </tr>
    <tr>
      <th>Xaxis2</th>
      <td><p>(list) passed to function 'axis' which allows to fully specify the X-axis labelling above the plot (see ?axis). This is used to specify the number
of observations per sub-group according to the group-labels. Default is to plot these numbers above the plot. To omit set to NULL.
Note, if 'horizontal=TRUE' this axis-labelling will appear in the right margin and labels will be oriented perpendicular to the axis.
Set 'Xaxis2=list(las=0)' to overwrite the default for usual parallel orientation.</p></td>
    </tr>
    <tr>
      <th>XaxisTab</th>
      <td><p>(list) or NULL, if a (possibly empty) list AND 'form' is specified, 'Xaxis' will be set to NULL and a table will be used a X-axis label
   representing the combination of factor-levels for all factors appearing in 'form' (see example document and see <code><a href='addXlabTable.html'>addXlabTable</a></code>).
If 'horizontal=TRUE' the table will appear in the left margin as any other setting originally intended to apply to an X-axis element.
   Note, there has to be enough space in the bottom margin for adding the table (use "mai" or "mar" in <code>par</code>).
   Your may specify 'XaxisTab' as list with two sub-lists "Label" and "Text", which will then be evaluated for rownames of the table ("Label")
and the text in the cells of the table ("Text") separately (see examples of function <code><a href='addXlabTable.html'>addXlabTable</a></code> for details).</p></td>
    </tr>
    <tr>
      <th>Yaxis</th>
      <td><p>(list) passed to function 'axis' which allows to fully specify the the appearence of the Y-axis (see ?axis).</p></td>
    </tr>
    <tr>
      <th>Ylabel</th>
      <td><p>(list) passed to function 'mtext' which can be used to fully specify the Y-axis label.</p></td>
    </tr>
    <tr>
      <th>Xlabel</th>
      <td><p>(list) passed to function 'mtext' which can be used to fully specify the X-axis label or even group labels (see example document).</p></td>
    </tr>
    <tr>
      <th>Title</th>
      <td><p>(list) passed to function 'title'.</p></td>
    </tr>
    <tr>
      <th>Grid</th>
      <td><p>(list) passed to function 'grid'. Set to NULL to omit (default). For adding a grid simply set 'Grid=TRUE' which applies default settings
for the added grid or fully specify the grid to be added by specifying each argument (see ?addGrid for details).</p></td>
    </tr>
    <tr>
      <th>transf</th>
      <td><p>(function) name of a function to be used to tranform data before plotting, e.g. log, log10 or user-defined functions,
i.e. func=function(x)x[x==0]&lt;-min(x, na.rm=TRUE)/2 and setting 'transf=func'.</p></td>
    </tr>
    <tr>
      <th>trend</th>
      <td><p>(character) "mean" = mean values are connected by a line emphasizing the dynamics (especially for time course data)
"median" = median values are used, set to NULL to omit.</p></td>
    </tr>
    <tr>
      <th>trend.lty</th>
      <td><p>(integer) line type of the trend line.</p></td>
    </tr>
    <tr>
      <th>trend.lwd</th>
      <td><p>(numeric) line width of the trend line.</p></td>
    </tr>
    <tr>
      <th>trend.col</th>
      <td><p>(character) color of the trend line.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>(integer) minimum number of points required for plotting a boxplot, otherwise only the stripchart will be plotted.</p></td>
    </tr>
    <tr>
      <th>border</th>
      <td><p>(character) string specifying the border color(s) of boxes. This can be a vector with different colors for multiple boxes.</p></td>
    </tr>
    <tr>
      <th>mean.pch</th>
      <td><p>(integer) plotting symbol for mean-values, which are added to the plot. Use '-1' to prevent plotting of mean-values.</p></td>
    </tr>
    <tr>
      <th>mean.cex</th>
      <td><p>(numeric) specifying the magnification of mean-value plotting symbols.</p></td>
    </tr>
    <tr>
      <th>mean.col</th>
      <td><p>(character) specifying the color of mean-value plotting symbols.</p></td>
    </tr>
    <tr>
      <th>mean.lwd</th>
      <td><p>(integer) specifying the line width of mean-value plotting symbols (cross, plus, asterisk etc.).</p></td>
    </tr>
    <tr>
      <th>vline</th>
      <td><p>(numeric) value(s) specifying vertical lines added to the plot.</p></td>
    </tr>
    <tr>
      <th>vl.lwd</th>
      <td><p>(integer) line width of vertical lines.</p></td>
    </tr>
    <tr>
      <th>vl.lty</th>
      <td><p>(integer) line type of vertical lines.</p></td>
    </tr>
    <tr>
      <th>vl.col</th>
      <td><p>(character) color of vertical lines.</p></td>
    </tr>
    <tr>
      <th>Box</th>
      <td><p>(logical) TRUE = a box is plotted surrounding the plot, FALSE = no box.</p></td>
    </tr>
    </table>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>input</span>)

<span class='co'>## specify variables to plot</span>
<span class='fu'>BoxPlot</span>(<span class='no'>input</span>, <span class='no'>KRAS.exprs</span>~<span class='no'>Arm</span>, <span class='kw'>transf</span> <span class='kw'>=</span> <span class='no'>log</span>)</div><div class='output co'>#&gt; <span class='message'>Number of samples removed due to missing Y: 89</span></div><div class='img'><img src='BoxPlot-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'>## same plot, now horizontally plotted</span>
<span class='fu'>BoxPlot</span>(<span class='no'>input</span>, <span class='no'>KRAS.exprs</span>~<span class='no'>Arm</span>, <span class='kw'>transf</span> <span class='kw'>=</span> <span class='no'>log</span>, <span class='kw'>horizontal</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
       <span class='kw'>Xaxis</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>las</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>hadj</span><span class='kw'>=</span><span class='fl'>2</span>), <span class='kw'>Xaxis2</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>las</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>hadj</span><span class='kw'>=</span>-<span class='fl'>.25</span>))</div><div class='output co'>#&gt; <span class='message'>Number of samples removed due to missing Y: 89</span></div><div class='img'><img src='BoxPlot-2.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
            
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Andre Schuetzenmeister <a href='mailto:andre.schuetzenmeister@roche.com'>andre.schuetzenmeister@roche.com</a>, Vinzent Rolny <a href='mailto:vinzent.rolny@roche.com'>vinzent.rolny@roche.com</a>, christina Rabe <a href='mailto:rabe.christina@gene.com'>rabe.christina@gene.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ning Leng, Alexey Pronin, Jemma Fan, Doug Kelkhoff, Christina Rabe, Kwame Okrah.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
